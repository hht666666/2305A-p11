<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>

</html>


<script>
    //实例化promise对象
    /**
     * 概念
     * promise函数是一个容器，里面存放着异步代码
     * 
     * 特点
     * 1.有三种状态pending 进行中   resolve 成功状态  rejected 失败状态
     * 2.状态一旦改变，就不会再变
     * 3.状态变化：pending -> resolve  pending -> rejected
     * 
     * promise底层原理是根据什么封装的
     * 根据js提供的网络请求xmlHttpRequest进行封装
     * **/


    //初始封装
    // const p = new Promise((resolve, reject) => {
    //     setTimeout(() => {
    //         let a = '成功'
    //         // resolve(a)
    //         let b = '失败'
    //         reject(b)
    //     }, 1000);
    // })
    // //完整调用
    // p.then((res) => {
    //     console.log(res);
    // })
    // p.catch((error) => {
    //     console.log(error);
    // })
    // //简写调用
    // p.then
    //     ((res) => {
    //         console.log(res);
    //     }),
    //     (error) => {
    //         console.log(error);
    //     }



    //链式调用
    /**
     * 解决了promise的回调地狱问题，一个then处理一个请求接口
     * 
     * catch 可以捕获前面then中出现的第一个错误
     * 如果第一个then报错了，那么catch不会往下执行
     * 
     * **/
    // const p = new Promise((resolve, reject) => {
    //     setTimeout(() => {
    //         const data = '我最帅'
    //         // resolve(data)
    //         reject('我是第一个报错信息')
    //     }, 1000);
    // })
    // //模拟接口报错
    // function name() {
    //     throw new Error('我是第二个报错信息')
    // }

    // p.then((res) => {
    //     console.log(res, '成功');
    //     return '我把这个值return出去,下一个.then就是接受这个值'
    // }).then((value) => {
    //     name()
    // }).then((res) => {
    //     console.log(res);
    // }).catch((error) => {
    //     console.log(error, 'err');
    // })


    //底层原理
    // const p = new Promise((resolve, reject) => {
    //     //创建对象，创建链接xmlHttpRequest
    //     const xhr = new XMLHttpRequest()
    //     //初始化
    //     xhr.open('GET', 'https://api.apiopen.top/getJoke')
    //     //发送请求
    //     xhr.send()
    //     //绑定事件，处理响应结果
    //     xhr.onreadystatechange = () => {
    //         //判断 等于4表示成功
    //         if (xhr.readyState === 4) {
    //             //判断响应状态码 200-299表示成功
    //             if (xhr.status >= 200 && xhr.status < 300) {
    //                 //表示成功
    //                 resolve(xhr.response)
    //             } else {
    //                 //表示失败
    //                 reject(xhr.status)
    //             }
    //         }
    //     }
    // })


    //all方法

    /**桃花源记**/
    const getPeachs = `晋太元1中，武陵人2捕鱼为业3。缘4溪行5，忘路之远近6。忽逢7桃花林，夹岸8数百步，中无杂9树，芳草鲜美10，落英11缤纷12。渔人甚异之13。复14前15行，欲16穷17其林。
林尽水源18，便19得20一山，山有小口，仿佛21若22有光。便舍23船，从口入。初24极狭，才通人25。复行26数十步，豁然开朗27。土地平28旷29，屋舍30俨然31，有良田美池桑竹之32属33。阡陌34交通，鸡犬相闻35。其中往来种作36，男女衣着37，悉38如外人39。黄发垂髫40，并41怡然42自乐。
见渔人，乃大惊43，问所从来44，具45答之46。便要47还家，设酒杀鸡作食。村中闻有此人，咸48来问讯49。自云50先世51避秦时乱，率52妻子53邑人54来此绝境55，不复56出焉57，遂58与外人间隔59。问今是何世60，乃61不知有汉，无论62魏晋。此人一一为63具言64所闻65，皆叹惋66。余67人各复延至68其家，皆出酒食。停数日，辞去69。此中人语70云：“不足71为72外人道也。”
既73出，得其船，便扶向路74，处处志之75。及郡下76，诣77太守，说如此78。太守即遣人随其往，寻向所志79，遂80迷，不复得81路。
南阳刘子骥，高82尚士83也84，闻之，欣然85规86往。未果87，寻88病终89，后遂无问津90者。`;
    /**出师表**/
    const getTroops = `
  先帝1创业2未半而中道3崩殂4，今5天下三分6，益州疲弊7，此8诚危急存亡之秋也。然9侍卫之臣不懈于内，忠志之士忘身10于外者，盖追先帝之殊遇11，欲报之于陛下也。诚宜12开张圣听13，以光14先帝遗德，恢弘15志士之气，不宜妄自菲薄16，引喻失义17，以塞忠谏之路也18。
宫中府中，俱为一体19；陟罚臧否20，不宜异同：若有作奸犯科21及为忠善者22，宜付有司23论其刑赏24，以昭陛下平明之理25；不宜偏私26，使内外异法也27。
侍中、侍郎郭攸之、费祎、董允等，此皆良实，志虑忠纯28，是以先帝简拔以遗陛下29：愚以为宫中之事，事无大小，悉以咨之30，然后施行，必能裨补阙漏31，有所广益32。
出师表书法
出师表书法(3张)
将军向宠，性行淑均33，晓畅34军事，试用35于昔日，先帝称之曰“能”，是以众议举宠为督36：愚以为营37中之事，悉以咨之，必能使行阵38和睦，优劣得所39。
亲贤臣，远小人40，此先汉所以兴隆也；亲小人，远贤臣，此后汉所以倾颓41也。先帝在时，每与臣论此事，未尝不叹息痛恨42于桓、灵也。侍中、尚书、长史、参军，此悉贞良死节43之臣，愿陛下亲之信之，则汉室之隆44，可计日45而待也。
臣本布衣46，躬耕于47南阳48，苟全49性命于乱世，不求闻达于诸侯50。先帝不以臣卑鄙51，猥52自枉屈，三顾53臣于草庐之中，咨臣以当世之事，由是感激54，遂许先帝以驱驰55。后值倾覆，受任于败军之际，奉命于危难之间：尔来二十有56一年矣。先帝知臣谨慎，故临崩寄臣以大事也57。受命以来，夙夜忧叹58，恐托付不效，以伤先帝之明；故五月渡泸59，深入不毛60。今南方已定，兵甲已足61，当奖率62三军，北定中原，庶竭驽钝63，攘除奸凶64，兴复汉室，还于旧都65。此臣所以报先帝而忠陛下之职分也66。至于斟酌损益67，进尽忠言，则攸之、祎、允之任也。
愿陛下托臣以讨贼兴复之效68，不效，则治臣之罪69，以告70先帝之灵。若无兴德之言71，则责攸之、祎、允等之慢72，以彰其咎73；陛下亦宜自谋，以咨诹善道74，察纳雅言75，深追先帝遗诏76。臣不胜受恩感激。今当77远离，临表涕零78，不知所言79.
  `;
    /**出居庸关**/
    const getAgent = `
  居庸关上子规啼，饮马流泉落日低。
  雨雪自飞千嶂外，榆林只隔数峰西。`;

    //出师表函数
    function fn(a) {
        return new Promise(function (resolve, reject) {
            setTimeout(() => {
                resolve(a);
            });
        })
    }

    Promise.all([fn(getPeachs), fn(getTroops), fn(getAgent)]).then((res) => {
        console.log(res);
    }).catch((err) => {
        console.log(err, 'err');
    })
</script>